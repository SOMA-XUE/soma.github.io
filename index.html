<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,minimum-scale=1.0, maximum-scale=1.0,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="./base.css">
    <link rel="stylesheet" href="./cloudGameBook.css">
</head>

<body>
    <div class="cloudGameBook">
        <br><br>
        <input type="number" class="phoneNum">
        <br><br>
        <button type="button" class="book">预约</button>

        <div class="modal">
            <div class="modalMain">
                <p class="modalMainContent"></p>
            </div>
        </div>
    </div>

    <script src="./zepto-1.1.6.js"></script>
    <script>
        Zepto(function ($) {
            // alert('Ready to Zepto!')
            $('.book').on('click', () => {
                // console.log('手机号码',$('.phoneNum').val())
                let phoneNum = $('.phoneNum').val(); // string格式的
                if (!/^1\d{10}$/.test(phoneNum)) {
                    // 手机号码格式错误
                    // TODO 提示用户

                    $('.modalMainContent').text('phone error')
                    return console.log('phone error');
                }
                $.ajax({
                    type: 'GET',
                    url: 'http://daoyu.sdo.com/mLottery/cloudGame/book',
                    data: {
                        phone: phoneNum,
                    },
                    dataType: 'jsonp',
                    jsonp: "callback", // cb
                    // jsonpCallback: "success_jsonpCallback",
                    success: function (res) {

                        console.log(res);
                        if (res.return_code === 0) {
                            $('.modalMainContent').text('预约成功')

                            console.log('预约成功');
                        } else {
                            $('.modalMainContent').text(res.return_message)

                            console.log(res.return_message);
                        }
                    },
                    error: function () {
                        $('.modalMainContent').text('ajax error')

                        console.log('ajax error');
                    }
                })
            })
        })
    </script>
</body>

</html>